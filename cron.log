Fetching data from 2025-05-05 to 2025-05-11...
Making request with rrdid=0...
Fetched 79459 records with rrdid=0.
All data for this range fetched.
Converting fetched data to DataFrame...
Waiting for 60 seconds before proceeding...
Processing file!
SQLAlchemy engine created successfully.
DataFrame successfully loaded into 'fin_rep' table.
Finished processing file
Fetching data from 2025-05-12 to 2025-05-18...
Making request with rrdid=0...
Fetched 100000 records with rrdid=0.
Limit of 100000 reached. Splitting the date range and fetching separately.
  Fetching data from 2025-05-12 to 2025-05-15...
  Making request with rrdid=0...
  Fetched 75003 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
  Fetching data from 2025-05-16 to 2025-05-18...
  Making request with rrdid=0...
  Fetched 47245 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
Processing file!
SQLAlchemy engine created successfully.
DataFrame successfully loaded into 'fin_rep' table.
Finished processing file
Fetching data from 2025-05-19 to 2025-05-25...
Making request with rrdid=0...
Fetched 100000 records with rrdid=0.
Limit of 100000 reached. Splitting the date range and fetching separately.
  Fetching data from 2025-05-19 to 2025-05-22...
  Making request with rrdid=0...
  Fetched 70289 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
  Fetching data from 2025-05-23 to 2025-05-25...
  Making request with rrdid=0...
  Fetched 65440 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
Processing file!
SQLAlchemy engine created successfully.
DataFrame successfully loaded into 'fin_rep' table.
Finished processing file
Fetching data from 2025-05-26 to 2025-06-01...
Making request with rrdid=0...
Fetched 100000 records with rrdid=0.
Limit of 100000 reached. Splitting the date range and fetching separately.
  Fetching data from 2025-05-26 to 2025-05-29...
  Making request with rrdid=0...
  Fetched 77505 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
  Fetching data from 2025-05-30 to 2025-06-01...
  Making request with rrdid=0...
  Fetched 50500 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
Processing file!
SQLAlchemy engine created successfully.
DataFrame successfully loaded into 'fin_rep' table.
Finished processing file
Fetching data from 2025-06-02 to 2025-06-08...
Making request with rrdid=0...
Fetched 100000 records with rrdid=0.
Limit of 100000 reached. Splitting the date range and fetching separately.
  Fetching data from 2025-06-02 to 2025-06-05...
  Making request with rrdid=0...
  Fetched 84447 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
  Fetching data from 2025-06-06 to 2025-06-08...
  Making request with rrdid=0...
  Fetched 36045 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
Processing file!
SQLAlchemy engine created successfully.
DataFrame successfully loaded into 'fin_rep' table.
Finished processing file
Fetching data from 2025-06-09 to 2025-06-15...
Making request with rrdid=0...
No more data to fetch for this range.
Converting fetched data to DataFrame...
Waiting for 60 seconds before proceeding...
Processing file!
Error processing file: The DataFrame is empty. No data to process.
Traceback (most recent call last):
  File "/root/fin_report/main.py", line 73, in <module>
    raise ValueError("The DataFrame is empty. No data to process.")
ValueError: The DataFrame is empty. No data to process.
Fetching data from 2025-06-16 to 2025-06-22...
Making request with rrdid=0...
Fetched 100000 records with rrdid=0.
Limit of 100000 reached. Splitting the date range and fetching separately.
  Fetching data from 2025-06-16 to 2025-06-19...
  Making request with rrdid=0...
  Fetched 75111 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
  Fetching data from 2025-06-20 to 2025-06-22...
  Making request with rrdid=0...
  Fetched 52529 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
Processing file!
SQLAlchemy engine created successfully.
DataFrame successfully loaded into 'fin_rep' table.
Finished processing file
Fetching data from 2025-06-23 to 2025-06-29...
Making request with rrdid=0...
Fetched 100000 records with rrdid=0.
Limit of 100000 reached. Splitting the date range and fetching separately.
  Fetching data from 2025-06-23 to 2025-06-26...
  Making request with rrdid=0...
  Fetched 92295 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
  Fetching data from 2025-06-27 to 2025-06-29...
  Making request with rrdid=0...
  Fetched 67094 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
Processing file!
SQLAlchemy engine created successfully.
DataFrame successfully loaded into 'api_wb_FinanceReport' table.
Finished processing file
Fetching data from 2025-06-30 to 2025-07-06...
Making request with rrdid=0...
Fetched 26307 records with rrdid=0.
All data for this range fetched.
Converting fetched data to DataFrame...
Waiting for 60 seconds before proceeding...
Processing file!
SQLAlchemy engine created successfully.
DataFrame successfully loaded into 'api_wb_FinanceReport' table.
Finished processing file
Fetching data from 2025-07-07 to 2025-07-13...
Making request with rrdid=0...
Fetched 100000 records with rrdid=0.
Limit of 100000 reached. Splitting the date range and fetching separately.
  Fetching data from 2025-07-07 to 2025-07-10...
  Making request with rrdid=0...
  Fetched 100000 records with rrdid=0.
  Limit of 100000 reached. Splitting the date range and fetching separately.
    Fetching data from 2025-07-07 to 2025-07-08...
    Making request with rrdid=0...
    Fetched 68901 records with rrdid=0.
    All data for this range fetched.
    Converting fetched data to DataFrame...
    Waiting for 60 seconds before proceeding...
    Fetching data from 2025-07-09 to 2025-07-10...
    Making request with rrdid=0...
    Fetched 62422 records with rrdid=0.
    All data for this range fetched.
    Converting fetched data to DataFrame...
    Waiting for 60 seconds before proceeding...
  Fetching data from 2025-07-11 to 2025-07-13...
  Making request with rrdid=0...
  Fetched 78276 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
Processing file!
SQLAlchemy engine created successfully.
DataFrame successfully loaded into 'api_wb_FinanceReport' table.
Finished processing file
Fetching data from 2025-07-14 to 2025-07-20...
Making request with rrdid=0...
Fetched 100000 records with rrdid=0.
Limit of 100000 reached. Splitting the date range and fetching separately.
  Fetching data from 2025-07-14 to 2025-07-17...
  Making request with rrdid=0...
  Fetched 98818 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
  Fetching data from 2025-07-18 to 2025-07-20...
  Making request with rrdid=0...
  Fetched 82077 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
Processing file!
SQLAlchemy engine created successfully.
Error loading DataFrame: (psycopg2.errors.UndefinedColumn) column "cashback_amount" of relation "api_wb_FinanceReport" does not exist
LINE 1: ...nt_cofinancing_amount, wibes_wb_discount_percent, cashback_a...
                                                             ^

[SQL: INSERT INTO "api_wb_FinanceReport" (realizationreport_id, date_from, date_to, create_dt, currency_name, suppliercontract_code, rrd_id, gi_id, dlv_prc, fix_tariff_date_from, fix_tariff_date_to, subject_name, nm_id, brand_name, sa_name, ts_name, barcod ... 773801 characters truncated ... s, %(cashback_amount__423)s, %(cashback_discount__423)s, %(kiz__423)s, %(rebill_logistic_org__423)s)]
[parameters: {'gi_box_type_name__0': 'Микс', 'ppvz_office_id__0': 149907, 'ppvz_for_pay__0': 0.0, 'quantity__0': 0, 'ppvz_inn__0': '', 'srid__0': '29393656111060707.0.0', 'ppvz_office_name__0': 'Брянская область Брянск улица Фокина 50', 'date_to__0': '2025-07-20', 'storage_fee__0': 0.0, 'sup_rating_prc_up__0': 0, 'ppvz_spp_prc__0': 0.0, 'acquiring_fee__0': 0.0, 'sticker_id__0': '0', 'order_dt__0': '2025-07-10T16:50:14Z', 'is_legal_entity__0': False, 'ppvz_kvw_prc__0': 0.0, 'assembly_id__0': 0, 'rr_dt__0': '2025-07-14', 'ppvz_vw__0': 0.0, 'office_name__0': 'Тула', 'date_from__0': '2025-07-14', 'create_dt__0': '2025-07-21', 'wibes_wb_discount_percent__0': 0, 'retail_amount__0': 0.0, 'declaration_number__0': '', 'ppvz_reward__0': 0.0, 'delivery_rub__0': 57.0, 'ppvz_vw_nds__0': 0.0, 'dlv_prc__0': 1.5, 'gi_id__0': 24698303, 'trbx_id__0': '0', 'site_country__0': 'Россия', 'additional_payment__0': 0, 'shk_id__0': 25359979910, 'rebill_logistic_org__0': None, 'fix_tariff_date_from__0': '2024-11-08T21:00:00Z', 'ts_name__0': '44', 'delivery_amount__0': 1, 'srv_dbs__0': False, 'supplier_promo__0': 0, 'barcode__0': '7777844000299', 'retail_price__0': 0.0, 'fix_tariff_date_to__0': '2025-01-07T21:00:00Z', 'is_kgvp_v2__0': 0, 'sale_dt__0': '2025-07-13T20:39:51Z', 'ppvz_kvw_prc_base__0': 0.0, 'currency_name__0': 'RUB', 'supplier_oper_name__0': 'Логистика', 'product_discount_for_report__0': 0, 'doc_type_name__0': '' ... 32548 parameters truncated ... 'ppvz_vw_nds__423': 2.3, 'dlv_prc__423': 0.0, 'gi_id__423': 28147583, 'trbx_id__423': '', 'site_country__423': 'Россия', 'additional_payment__423': 0, 'shk_id__423': 29930340378, 'rebill_logistic_org__423': None, 'fix_tariff_date_from__423': '', 'ts_name__423': '4-5 Y', 'delivery_amount__423': 0, 'srv_dbs__423': False, 'supplier_promo__423': 0, 'barcode__423': '9999620912244', 'retail_price__423': 1168.0, 'fix_tariff_date_to__423': '', 'is_kgvp_v2__423': 0, 'sale_dt__423': '2025-07-14T06:44:48Z', 'ppvz_kvw_prc_base__423': 20.42, 'currency_name__423': 'RUB', 'supplier_oper_name__423': 'Продажа', 'product_discount_for_report__423': 0, 'doc_type_name__423': 'Продажа', 'acquiring_bank__423': 'Вайлдберриз Банк', 'installment_cofinancing_amount__423': 0, 'ppvz_sales_commission__423': 11.5, 'rrd_id__423': 2929248791196, 'deduction__423': 0.0, 'subject_name__423': 'Платья', 'commission_percent__423': 28.75, 'cashback_amount__423': 0, 'penalty__423': 0, 'report_type__423': 1, 'brand_name__423': 'Marks & Spencer', 'sa_name__423': 't77-2073k-navy', 'sale_percent__423': 0, 'return_amount__423': 0, 'retail_price_withdisc_rub__423': 1168.0, 'suppliercontract_code__423': None, 'payment_processing__423': 'Перевыставление эквайринга', 'ppvz_supplier_id__423': 0, 'kiz__423': '0104620373348811215JXPOYc&;>,?>\x1d91EE10\x1d922MImqVS11qp/75te0WXTQKv7moYvFJFzoBTNEc4Bi90=', 'realizationreport_id__423': 425658792, 'acquiring_percent__423': 1.9, 'cashback_discount__423': 0, 'rebill_logistic_cost__423': 0.0, 'ppvz_supplier_name__423': '', 'bonus_type_name__423': None, 'nm_id__423': 311043623, 'acceptance__423': 0.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Error processing file: (psycopg2.errors.UndefinedColumn) column "cashback_amount" of relation "api_wb_FinanceReport" does not exist
LINE 1: ...nt_cofinancing_amount, wibes_wb_discount_percent, cashback_a...
                                                             ^

[SQL: INSERT INTO "api_wb_FinanceReport" (realizationreport_id, date_from, date_to, create_dt, currency_name, suppliercontract_code, rrd_id, gi_id, dlv_prc, fix_tariff_date_from, fix_tariff_date_to, subject_name, nm_id, brand_name, sa_name, ts_name, barcod ... 773801 characters truncated ... s, %(cashback_amount__423)s, %(cashback_discount__423)s, %(kiz__423)s, %(rebill_logistic_org__423)s)]
[parameters: {'gi_box_type_name__0': 'Микс', 'ppvz_office_id__0': 149907, 'ppvz_for_pay__0': 0.0, 'quantity__0': 0, 'ppvz_inn__0': '', 'srid__0': '29393656111060707.0.0', 'ppvz_office_name__0': 'Брянская область Брянск улица Фокина 50', 'date_to__0': '2025-07-20', 'storage_fee__0': 0.0, 'sup_rating_prc_up__0': 0, 'ppvz_spp_prc__0': 0.0, 'acquiring_fee__0': 0.0, 'sticker_id__0': '0', 'order_dt__0': '2025-07-10T16:50:14Z', 'is_legal_entity__0': False, 'ppvz_kvw_prc__0': 0.0, 'assembly_id__0': 0, 'rr_dt__0': '2025-07-14', 'ppvz_vw__0': 0.0, 'office_name__0': 'Тула', 'date_from__0': '2025-07-14', 'create_dt__0': '2025-07-21', 'wibes_wb_discount_percent__0': 0, 'retail_amount__0': 0.0, 'declaration_number__0': '', 'ppvz_reward__0': 0.0, 'delivery_rub__0': 57.0, 'ppvz_vw_nds__0': 0.0, 'dlv_prc__0': 1.5, 'gi_id__0': 24698303, 'trbx_id__0': '0', 'site_country__0': 'Россия', 'additional_payment__0': 0, 'shk_id__0': 25359979910, 'rebill_logistic_org__0': None, 'fix_tariff_date_from__0': '2024-11-08T21:00:00Z', 'ts_name__0': '44', 'delivery_amount__0': 1, 'srv_dbs__0': False, 'supplier_promo__0': 0, 'barcode__0': '7777844000299', 'retail_price__0': 0.0, 'fix_tariff_date_to__0': '2025-01-07T21:00:00Z', 'is_kgvp_v2__0': 0, 'sale_dt__0': '2025-07-13T20:39:51Z', 'ppvz_kvw_prc_base__0': 0.0, 'currency_name__0': 'RUB', 'supplier_oper_name__0': 'Логистика', 'product_discount_for_report__0': 0, 'doc_type_name__0': '' ... 32548 parameters truncated ... 'ppvz_vw_nds__423': 2.3, 'dlv_prc__423': 0.0, 'gi_id__423': 28147583, 'trbx_id__423': '', 'site_country__423': 'Россия', 'additional_payment__423': 0, 'shk_id__423': 29930340378, 'rebill_logistic_org__423': None, 'fix_tariff_date_from__423': '', 'ts_name__423': '4-5 Y', 'delivery_amount__423': 0, 'srv_dbs__423': False, 'supplier_promo__423': 0, 'barcode__423': '9999620912244', 'retail_price__423': 1168.0, 'fix_tariff_date_to__423': '', 'is_kgvp_v2__423': 0, 'sale_dt__423': '2025-07-14T06:44:48Z', 'ppvz_kvw_prc_base__423': 20.42, 'currency_name__423': 'RUB', 'supplier_oper_name__423': 'Продажа', 'product_discount_for_report__423': 0, 'doc_type_name__423': 'Продажа', 'acquiring_bank__423': 'Вайлдберриз Банк', 'installment_cofinancing_amount__423': 0, 'ppvz_sales_commission__423': 11.5, 'rrd_id__423': 2929248791196, 'deduction__423': 0.0, 'subject_name__423': 'Платья', 'commission_percent__423': 28.75, 'cashback_amount__423': 0, 'penalty__423': 0, 'report_type__423': 1, 'brand_name__423': 'Marks & Spencer', 'sa_name__423': 't77-2073k-navy', 'sale_percent__423': 0, 'return_amount__423': 0, 'retail_price_withdisc_rub__423': 1168.0, 'suppliercontract_code__423': None, 'payment_processing__423': 'Перевыставление эквайринга', 'ppvz_supplier_id__423': 0, 'kiz__423': '0104620373348811215JXPOYc&;>,?>\x1d91EE10\x1d922MImqVS11qp/75te0WXTQKv7moYvFJFzoBTNEc4Bi90=', 'realizationreport_id__423': 425658792, 'acquiring_percent__423': 1.9, 'cashback_discount__423': 0, 'rebill_logistic_cost__423': 0.0, 'ppvz_supplier_name__423': '', 'bonus_type_name__423': None, 'nm_id__423': 311043623, 'acceptance__423': 0.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "cashback_amount" of relation "api_wb_FinanceReport" does not exist
LINE 1: ...nt_cofinancing_amount, wibes_wb_discount_percent, cashback_a...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/root/api_wb_FinanceReport/main.py", line 60, in <module>
    engine = connection.load_dataframe_to_postgresql(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/api_wb_FinanceReport/connection.py", line 47, in load_dataframe_to_postgresql
    df.to_sql(name=table_name, con=engine, if_exists='append', index=False)
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
  File "/root/api_wb_FinanceReport/myenv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "cashback_amount" of relation "api_wb_FinanceReport" does not exist
LINE 1: ...nt_cofinancing_amount, wibes_wb_discount_percent, cashback_a...
                                                             ^

[SQL: INSERT INTO "api_wb_FinanceReport" (realizationreport_id, date_from, date_to, create_dt, currency_name, suppliercontract_code, rrd_id, gi_id, dlv_prc, fix_tariff_date_from, fix_tariff_date_to, subject_name, nm_id, brand_name, sa_name, ts_name, barcod ... 773801 characters truncated ... s, %(cashback_amount__423)s, %(cashback_discount__423)s, %(kiz__423)s, %(rebill_logistic_org__423)s)]
[parameters: {'gi_box_type_name__0': 'Микс', 'ppvz_office_id__0': 149907, 'ppvz_for_pay__0': 0.0, 'quantity__0': 0, 'ppvz_inn__0': '', 'srid__0': '29393656111060707.0.0', 'ppvz_office_name__0': 'Брянская область Брянск улица Фокина 50', 'date_to__0': '2025-07-20', 'storage_fee__0': 0.0, 'sup_rating_prc_up__0': 0, 'ppvz_spp_prc__0': 0.0, 'acquiring_fee__0': 0.0, 'sticker_id__0': '0', 'order_dt__0': '2025-07-10T16:50:14Z', 'is_legal_entity__0': False, 'ppvz_kvw_prc__0': 0.0, 'assembly_id__0': 0, 'rr_dt__0': '2025-07-14', 'ppvz_vw__0': 0.0, 'office_name__0': 'Тула', 'date_from__0': '2025-07-14', 'create_dt__0': '2025-07-21', 'wibes_wb_discount_percent__0': 0, 'retail_amount__0': 0.0, 'declaration_number__0': '', 'ppvz_reward__0': 0.0, 'delivery_rub__0': 57.0, 'ppvz_vw_nds__0': 0.0, 'dlv_prc__0': 1.5, 'gi_id__0': 24698303, 'trbx_id__0': '0', 'site_country__0': 'Россия', 'additional_payment__0': 0, 'shk_id__0': 25359979910, 'rebill_logistic_org__0': None, 'fix_tariff_date_from__0': '2024-11-08T21:00:00Z', 'ts_name__0': '44', 'delivery_amount__0': 1, 'srv_dbs__0': False, 'supplier_promo__0': 0, 'barcode__0': '7777844000299', 'retail_price__0': 0.0, 'fix_tariff_date_to__0': '2025-01-07T21:00:00Z', 'is_kgvp_v2__0': 0, 'sale_dt__0': '2025-07-13T20:39:51Z', 'ppvz_kvw_prc_base__0': 0.0, 'currency_name__0': 'RUB', 'supplier_oper_name__0': 'Логистика', 'product_discount_for_report__0': 0, 'doc_type_name__0': '' ... 32548 parameters truncated ... 'ppvz_vw_nds__423': 2.3, 'dlv_prc__423': 0.0, 'gi_id__423': 28147583, 'trbx_id__423': '', 'site_country__423': 'Россия', 'additional_payment__423': 0, 'shk_id__423': 29930340378, 'rebill_logistic_org__423': None, 'fix_tariff_date_from__423': '', 'ts_name__423': '4-5 Y', 'delivery_amount__423': 0, 'srv_dbs__423': False, 'supplier_promo__423': 0, 'barcode__423': '9999620912244', 'retail_price__423': 1168.0, 'fix_tariff_date_to__423': '', 'is_kgvp_v2__423': 0, 'sale_dt__423': '2025-07-14T06:44:48Z', 'ppvz_kvw_prc_base__423': 20.42, 'currency_name__423': 'RUB', 'supplier_oper_name__423': 'Продажа', 'product_discount_for_report__423': 0, 'doc_type_name__423': 'Продажа', 'acquiring_bank__423': 'Вайлдберриз Банк', 'installment_cofinancing_amount__423': 0, 'ppvz_sales_commission__423': 11.5, 'rrd_id__423': 2929248791196, 'deduction__423': 0.0, 'subject_name__423': 'Платья', 'commission_percent__423': 28.75, 'cashback_amount__423': 0, 'penalty__423': 0, 'report_type__423': 1, 'brand_name__423': 'Marks & Spencer', 'sa_name__423': 't77-2073k-navy', 'sale_percent__423': 0, 'return_amount__423': 0, 'retail_price_withdisc_rub__423': 1168.0, 'suppliercontract_code__423': None, 'payment_processing__423': 'Перевыставление эквайринга', 'ppvz_supplier_id__423': 0, 'kiz__423': '0104620373348811215JXPOYc&;>,?>\x1d91EE10\x1d922MImqVS11qp/75te0WXTQKv7moYvFJFzoBTNEc4Bi90=', 'realizationreport_id__423': 425658792, 'acquiring_percent__423': 1.9, 'cashback_discount__423': 0, 'rebill_logistic_cost__423': 0.0, 'ppvz_supplier_name__423': '', 'bonus_type_name__423': None, 'nm_id__423': 311043623, 'acceptance__423': 0.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Fetching data from 2025-07-21 to 2025-07-27...
Making request with rrdid=0...
Fetched 100000 records with rrdid=0.
Limit of 100000 reached. Splitting the date range and fetching separately.
  Fetching data from 2025-07-21 to 2025-07-24...
  Making request with rrdid=0...
  Fetched 100000 records with rrdid=0.
  Limit of 100000 reached. Splitting the date range and fetching separately.
    Fetching data from 2025-07-21 to 2025-07-22...
    Making request with rrdid=0...
    Fetched 61563 records with rrdid=0.
    All data for this range fetched.
    Converting fetched data to DataFrame...
    Waiting for 60 seconds before proceeding...
    Fetching data from 2025-07-23 to 2025-07-24...
    Making request with rrdid=0...
    Fetched 50613 records with rrdid=0.
    All data for this range fetched.
    Converting fetched data to DataFrame...
    Waiting for 60 seconds before proceeding...
  Fetching data from 2025-07-25 to 2025-07-27...
  Making request with rrdid=0...
  Fetched 58448 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
Processing file!
SQLAlchemy engine created successfully.
DataFrame successfully loaded into 'api_wb_FinanceReport' table.
Finished processing file
Fetching data from 2025-07-28 to 2025-08-03...
Making request with rrdid=0...
Fetched 100000 records with rrdid=0.
Limit of 100000 reached. Splitting the date range and fetching separately.
  Fetching data from 2025-07-28 to 2025-07-31...
  Making request with rrdid=0...
  Fetched 78237 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
  Fetching data from 2025-08-01 to 2025-08-03...
  Making request with rrdid=0...
  Fetched 44854 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
Processing file!
SQLAlchemy engine created successfully.
DataFrame successfully loaded into 'api_wb_FinanceReport' table.
Finished processing file
Fetching data from 2025-08-04 to 2025-08-10...
Making request with rrdid=0...
Fetched 100000 records with rrdid=0.
Limit of 100000 reached. Splitting the date range and fetching separately.
  Fetching data from 2025-08-04 to 2025-08-07...
  Making request with rrdid=0...
  Fetched 98998 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
  Fetching data from 2025-08-08 to 2025-08-10...
  Making request with rrdid=0...
  Fetched 45554 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
Processing file!
SQLAlchemy engine created successfully.
DataFrame successfully loaded into 'api_wb_FinanceReport' table.
Finished processing file
Fetching data from 2025-08-11 to 2025-08-17...
Making request with rrdid=0...
Fetched 100000 records with rrdid=0.
Limit of 100000 reached. Splitting the date range and fetching separately.
  Fetching data from 2025-08-11 to 2025-08-14...
  Making request with rrdid=0...
  Fetched 79952 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
  Fetching data from 2025-08-15 to 2025-08-17...
  Making request with rrdid=0...
  Fetched 47690 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
Processing file!
SQLAlchemy engine created successfully.
DataFrame successfully loaded into 'api_wb_FinanceReport' table.
Finished processing file
Fetching data from 2025-08-18 to 2025-08-24...
Making request with rrdid=0...
Fetched 100000 records with rrdid=0.
Limit of 100000 reached. Splitting the date range and fetching separately.
  Fetching data from 2025-08-18 to 2025-08-21...
  Making request with rrdid=0...
  Fetched 99358 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
  Fetching data from 2025-08-22 to 2025-08-24...
  Making request with rrdid=0...
  Fetched 51674 records with rrdid=0.
  All data for this range fetched.
  Converting fetched data to DataFrame...
  Waiting for 60 seconds before proceeding...
Processing file!
SQLAlchemy engine created successfully.
DataFrame successfully loaded into 'api_wb_FinanceReport' table.
Finished processing file
Killed
Killed
Killed
